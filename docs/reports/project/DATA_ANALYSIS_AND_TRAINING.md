# 数据分析与深度学习训练报告

## 执行时间
2024-12-14

## 数据概况

### 已爬取的小说
- **数量**: 8 本
- **类型**: 都市
- **来源**: m.shuhaige.net
- **总大小**: 29 MB
- **总字符数**: 10,819,855 字符
- **总章节数**: 5,657 章

### 小说列表
1. 道之理想国
2. 女帝每日一问，今天他没变强吧？
3. 农村三代人
4. 我的人生无限抉择
5. 重生75，下乡插队打造科技帝国
6. 赘婿被嫌弃，哪知他体内住着神仙
7. 1981，文豪从返城知青开始
8. 透视医武在身的外卖骑手

## 数据分析与处理

### 1. 数据整理 ✅
- **处理文件数**: 8 本
- **成功处理**: 8 本
- **失败文件**: 0 本
- **质量分布**:
  - 高质量 (>=80): 8 本
  - 中等质量 (50-79): 0 本
  - 低质量 (<50): 0 本

### 2. 特征分析 ✅
- **总小说数**: 10 本（包含整理后的数据）
- **总字符数**: 17,244,689 字符
- **分析结果**: 已保存到 `data/training/processed/analysis.json`

### 3. 训练数据生成 ✅

#### 数据拆分策略
- **最小文本块长度**: 300 字符（保持上下文）
- **最大文本块长度**: 3000 字符（保持上下文）
- **文本块重叠**: 200 字符（保持连续性）
- **上下文窗口**: 500 字符（用于保持前后文连贯）
- **每本小说最多样本数**: 200 个

#### 数据增强
- **原始样本数**: 1,600 条
- **增强后样本数**: 2,600 条
- **增加样本数**: 1,000 条（62.5% 增长）
- **增强方法**:
  - 同义词替换
  - 回译模拟
  - 数据集平衡

#### 最终训练数据
- **总样本数**: 258,624 条（约 26 万条）
- **数据文件**: `data/training/processed/training_data.txt`
- **统计文件**: `data/training/processed/training_stats.json`
- **数据分布**:
  - 网站: m.shuhaige.net (100%)
  - 类型: 都市 (100%)

## 深度学习训练

### 训练配置
- **训练模式**: 基础训练
- **训练轮数**: 10 epochs
- **批次大小**: 8
- **模型类型**: Transformer 文本改写模型

### 训练状态
- **状态**: 进行中
- **模型保存路径**: `models/text_rewriter/`

### 训练数据格式
每行训练数据格式：
```
原始文本 | 改写文本 | 风格标签
```

示例：
```
自从国增转学后，在王文中学念书的马景明，学习成绩却每况愈下。景明真的学不进去了，觉得自己，每天坐在教室里，如坐针毡。现在已经，升入了初三年级，而初三的课，大多数是复习课，一道题目，往往关联好几个知识点。
```

## 数据质量

### 质量指标
- ✅ 所有小说均为高质量（>=80分）
- ✅ 数据完整性良好
- ✅ 章节结构清晰
- ✅ 文本内容连贯

### 数据特点
1. **类型统一**: 全部为都市类型，风格一致
2. **内容完整**: 所有小说均为已完结作品
3. **质量优秀**: 所有小说通过质量验证
4. **数据量大**: 超过 1000 万字符，26 万条训练样本

## 文件结构

```
data/training/
├── novels/                    # 原始爬取数据
│   └── m.shuhaige.net/
│       └── 都市/
│           └── [8本小说]/
│               ├── *.txt
│               └── *.json
├── processed/                 # 处理后的数据
│   ├── 都市/                  # 整理后的数据
│   ├── analysis.json          # 分析结果
│   ├── training_data.txt      # 训练数据（258,624条）
│   └── training_stats.json    # 训练统计
└── models/                    # 模型文件（训练中）
    └── text_rewriter/
```

## 下一步计划

1. **监控训练进度**: 观察模型训练效果
2. **评估模型性能**: 训练完成后进行模型评估
3. **增量训练**: 可以继续添加更多数据进行增量训练
4. **模型优化**: 根据训练结果调整超参数

## 技术细节

### 数据增强技术
- **同义词替换**: 保持语义不变，增加数据多样性
- **回译模拟**: 通过改写模拟回译效果
- **数据集平衡**: 确保不同风格的样本分布均匀

### 文本拆分策略
- **滑动窗口**: 使用重叠窗口保持上下文连贯性
- **章节感知**: 识别章节边界，避免跨章节拆分
- **长度控制**: 确保每个样本有足够的上下文信息

### 模型架构
- **Transformer**: 使用 Transformer 架构进行文本改写
- **字符级编码**: 支持中文字符处理
- **位置编码**: 保持序列位置信息
- **多头注意力**: 捕获长距离依赖关系

## 注意事项

1. **训练时间**: 26万条样本的训练可能需要较长时间，请耐心等待
2. **资源占用**: 训练过程会占用一定的CPU/内存资源
3. **模型保存**: 训练过程中会自动保存检查点
4. **数据备份**: 建议定期备份训练数据和模型文件

## 相关文件

- `scripts/core/training_data_generator.py` - 训练数据生成器
- `scripts/core/pipeline.py` - 数据处理流水线
- `scripts/ai/models/train_model.py` - 模型训练脚本
- `scripts/utils/data_enhancer.py` - 数据增强工具

