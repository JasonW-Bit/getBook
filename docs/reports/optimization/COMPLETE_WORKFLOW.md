# å®Œæ•´å·¥ä½œæµç¨‹æ–‡æ¡£

## æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿°äº†ä»æ•°æ®çˆ¬å–åˆ°æ¨¡å‹è®­ç»ƒçš„å®Œæ•´å·¥ä½œæµç¨‹ï¼ŒåŒ…æ‹¬æ‰€æœ‰æ­¥éª¤ã€å·¥å…·å’Œæ³¨æ„äº‹é¡¹ã€‚

## å®Œæ•´æµç¨‹

```
æ•°æ®çˆ¬å– â†’ æ•°æ®æ•´ç†ï¼ˆå¯é€‰ï¼‰â†’ æ•°æ®åˆ†æ â†’ è®­ç»ƒæ•°æ®ç”Ÿæˆ â†’ æ¨¡å‹è®­ç»ƒ â†’ æ¨¡å‹è¯„ä¼°
```

## è¯¦ç»†æ­¥éª¤

### é˜¶æ®µ1: æ•°æ®çˆ¬å– ğŸ“¥

**ç›®æ ‡**: ä»ç½‘ç«™çˆ¬å–å°è¯´æ•°æ®

**å·¥å…·**: `scripts/scraper/multi_site_scraper.py`

**å‘½ä»¤**:
```bash
python3 scripts/scraper/multi_site_scraper.py \
  --site m.shuhaige.net \
  --category éƒ½å¸‚ \
  --count 10
```

**è¾“å‡ºç»“æ„**:
```
data/training/novels/
â””â”€â”€ m.shuhaige.net/
    â””â”€â”€ éƒ½å¸‚/
        â””â”€â”€ <å°è¯´å>/
            â”œâ”€â”€ <å°è¯´å>.txt
            â””â”€â”€ <å°è¯´å>.json
```

**ç‰¹ç‚¹**:
- è‡ªåŠ¨ç­›é€‰å·²å®Œç»“å°è¯´
- è‡ªåŠ¨æ¸…ç†ä¸´æ—¶æ–‡ä»¶
- æ•°æ®è´¨é‡éªŒè¯
- æ”¯æŒæ–­ç‚¹ç»­ä¼ 

**è¾“å‡ºæ–‡ä»¶**:
- `data/training/novels/<ç½‘ç«™>/<ç±»å‹>/<å°è¯´å>/<å°è¯´å>.txt`
- `data/training/novels/<ç½‘ç«™>/<ç±»å‹>/<å°è¯´å>/<å°è¯´å>.json`

---

### é˜¶æ®µ2: æ•°æ®æ•´ç†ï¼ˆå¯é€‰ï¼‰ğŸ§¹

**ç›®æ ‡**: æ¸…ç†å’Œæ•´ç†çˆ¬å–çš„æ•°æ®

**å·¥å…·**: `scripts/utils/data_organizer.py`

**å‘½ä»¤**:
```bash
python3 scripts/core/pipeline.py --skip scrape --organize
```

**è¾“å‡ºç»“æ„**:
```
data/training/processed/
â””â”€â”€ <ç±»å‹>/
    â””â”€â”€ <å°è¯´å>.txt
```

**å¤„ç†å†…å®¹**:
- æ–‡æœ¬æ¸…ç†ï¼ˆç§»é™¤å¹¿å‘Šã€æ— å…³å†…å®¹ï¼‰
- å…ƒæ•°æ®æå–
- è´¨é‡è¯„åˆ†
- æŒ‰ç±»å‹åˆ†ç±»

**æ³¨æ„**: 
- æ•´ç†åçš„ç»“æ„ä¼šä¸¢å¤±ç½‘ç«™ä¿¡æ¯
- ç›®å½•ç»“æ„å˜ä¸ºï¼š`ç±»å‹/å°è¯´å.txt`
- å¦‚æœä½¿ç”¨æ­¤ç»“æ„ï¼Œéœ€è¦ç¡®ä¿è®­ç»ƒæ•°æ®ç”Ÿæˆå™¨æ”¯æŒ

---

### é˜¶æ®µ3: æ•°æ®åˆ†æ ğŸ“Š

**ç›®æ ‡**: åˆ†æå°è¯´ç‰¹å¾å’Œç»Ÿè®¡ä¿¡æ¯

**å·¥å…·**: `scripts/scraper/novel_analyzer.py`

**å‘½ä»¤**:
```bash
# è‡ªåŠ¨åœ¨pipelineä¸­æ‰§è¡Œ
python3 scripts/core/pipeline.py --skip scrape
```

**è¾“å‡ºæ–‡ä»¶**:
- `data/training/processed/analysis.json`

**åˆ†æå†…å®¹**:
- æ€»å­—ç¬¦æ•°
- æ€»ç« èŠ‚æ•°
- å¹³å‡ç« èŠ‚é•¿åº¦
- è´¨é‡è¯„åˆ†
- ç±»å‹åˆ†å¸ƒ

---

### é˜¶æ®µ4: è®­ç»ƒæ•°æ®ç”Ÿæˆ ğŸ”„

**ç›®æ ‡**: å°†å°è¯´æ–‡æœ¬è½¬æ¢ä¸ºè®­ç»ƒæ ·æœ¬

**å·¥å…·**: `scripts/core/training_data_generator.py`

**å‘½ä»¤**:
```bash
# è‡ªåŠ¨åœ¨pipelineä¸­æ‰§è¡Œ
python3 scripts/core/pipeline.py --skip scrape
```

**å¤„ç†æ­¥éª¤**:

1. **æ–‡æœ¬æ‹†åˆ†**
   - ä½¿ç”¨æ»‘åŠ¨çª—å£
   - ä¿æŒä¸Šä¸‹æ–‡è¿è´¯æ€§
   - è¯†åˆ«ç« èŠ‚è¾¹ç•Œ

2. **æ•°æ®å¢å¼º**ï¼ˆå¯é€‰ï¼‰
   - åŒä¹‰è¯æ›¿æ¢
   - å›è¯‘æ¨¡æ‹Ÿ
   - æ•°æ®é›†å¹³è¡¡

3. **æ ·æœ¬ç”Ÿæˆ**
   - åŸå§‹æ–‡æœ¬ â†’ æ”¹å†™æ–‡æœ¬
   - æ·»åŠ é£æ ¼æ ‡ç­¾
   - è´¨é‡æ§åˆ¶

**è¾“å‡ºæ–‡ä»¶**:
- `data/training/processed/training_data.txt`
- `data/training/processed/training_stats.json`

**æ•°æ®æ ¼å¼**:
```
åŸå§‹æ–‡æœ¬ | æ”¹å†™æ–‡æœ¬ | é£æ ¼æ ‡ç­¾
```

**é…ç½®å‚æ•°**:
- `MIN_CHUNK_LENGTH = 300` - æœ€å°æ–‡æœ¬å—é•¿åº¦
- `MAX_CHUNK_LENGTH = 3000` - æœ€å¤§æ–‡æœ¬å—é•¿åº¦
- `CHUNK_OVERLAP = 200` - æ–‡æœ¬å—é‡å 
- `MAX_SAMPLES_PER_NOVEL = 200` - æ¯æœ¬å°è¯´æœ€å¤šæ ·æœ¬æ•°

---

### é˜¶æ®µ5: æ¨¡å‹è®­ç»ƒ ğŸ¯

**ç›®æ ‡**: è®­ç»ƒæ·±åº¦å­¦ä¹ æ¨¡å‹

**å·¥å…·**: `scripts/ai/models/train_model.py`

**å‘½ä»¤**:
```bash
# è‡ªåŠ¨åœ¨pipelineä¸­æ‰§è¡Œ
python3 scripts/core/pipeline.py --skip scrape --epochs 20 --batch-size 16
```

**è®­ç»ƒé…ç½®**:
- **æ¨¡å‹ç±»å‹**: Transformer
- **è®­ç»ƒè½®æ•°**: 20 epochsï¼ˆå¯é…ç½®ï¼‰
- **æ‰¹æ¬¡å¤§å°**: 16ï¼ˆå¯é…ç½®ï¼‰
- **ä¼˜åŒ–å™¨**: Adam
- **å­¦ä¹ ç‡**: åŠ¨æ€è°ƒæ•´

**è¾“å‡ºæ–‡ä»¶**:
- `models/text_rewriter/` - æ¨¡å‹ç›®å½•
- æ£€æŸ¥ç‚¹æ–‡ä»¶
- æ¨¡å‹æƒé‡

---

### é˜¶æ®µ6: æ¨¡å‹è¯„ä¼° ğŸ“ˆ

**ç›®æ ‡**: è¯„ä¼°æ¨¡å‹æ€§èƒ½

**å·¥å…·**: `scripts/ai/models/model_evaluator.py`

**è¯„ä¼°æŒ‡æ ‡**:
- å‡†ç¡®ç‡
- å›°æƒ‘åº¦
- ç”Ÿæˆè´¨é‡
- ä¸€è‡´æ€§æ£€æŸ¥

---

## æ¨èå·¥ä½œæµç¨‹

### æµç¨‹1: å®Œæ•´æµç¨‹ï¼ˆæ¨èï¼‰

```bash
# ä¸€æ­¥å®Œæˆæ‰€æœ‰æ­¥éª¤
python3 scripts/core/pipeline.py \
  --site m.shuhaige.net \
  --category éƒ½å¸‚ \
  --count 10 \
  --epochs 20 \
  --batch-size 16
```

**ä¼˜ç‚¹**:
- è‡ªåŠ¨åŒ–ç¨‹åº¦é«˜
- æ— éœ€æ‰‹åŠ¨å¹²é¢„
- ä¿æŒå®Œæ•´ç›®å½•ç»“æ„

### æµç¨‹2: åˆ†æ­¥æ‰§è¡Œ

```bash
# æ­¥éª¤1: çˆ¬å–æ•°æ®
python3 scripts/scraper/multi_site_scraper.py \
  --site m.shuhaige.net \
  --category éƒ½å¸‚ \
  --count 10

# æ­¥éª¤2-5: åˆ†æã€ç”Ÿæˆã€è®­ç»ƒ
python3 scripts/core/pipeline.py \
  --skip scrape \
  --epochs 20 \
  --batch-size 16
```

**ä¼˜ç‚¹**:
- å¯ä»¥åˆ†æ­¥æ£€æŸ¥ç»“æœ
- çµæ´»æ§åˆ¶æ¯ä¸ªæ­¥éª¤

### æµç¨‹3: ä½¿ç”¨æ•´ç†åçš„æ•°æ®

```bash
# æ­¥éª¤1: çˆ¬å–
python3 scripts/scraper/multi_site_scraper.py \
  --site m.shuhaige.net \
  --category éƒ½å¸‚ \
  --count 10

# æ­¥éª¤2: æ•´ç†
python3 scripts/core/pipeline.py --skip scrape --organize

# æ­¥éª¤3-5: åˆ†æã€ç”Ÿæˆã€è®­ç»ƒ
python3 scripts/core/pipeline.py \
  --skip scrape,organize \
  --epochs 20
```

**æ³¨æ„**: éœ€è¦ç¡®ä¿è®­ç»ƒæ•°æ®ç”Ÿæˆå™¨æ”¯æŒprocessedç›®å½•ç»“æ„

---

## å¸¸è§é—®é¢˜

### Q1: è®­ç»ƒæ•°æ®ç”Ÿæˆä¸º0æ¡æ ·æœ¬ï¼Ÿ

**åŸå› **:
- ç›®å½•ç»“æ„ä¸åŒ¹é…
- æ–‡ä»¶æ ¼å¼ä¸æ­£ç¡®
- æ•°æ®ä¸ºç©º

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ç›®å½•ç»“æ„æ˜¯å¦ç¬¦åˆè¦æ±‚
2. ä½¿ç”¨ `--skip organize` ç›´æ¥ä½¿ç”¨novelsç›®å½•
3. æ£€æŸ¥æ•°æ®æ–‡ä»¶æ˜¯å¦åŒ…å«æœ‰æ•ˆå†…å®¹

### Q2: è®­ç»ƒå¤±è´¥ï¼Ÿ

**åŸå› **:
- è®­ç»ƒæ•°æ®ä¸è¶³
- å†…å­˜ä¸è¶³
- æ¨¡å‹é…ç½®é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. å¢åŠ è®­ç»ƒæ•°æ®é‡
2. å‡å°batch_size
3. æ£€æŸ¥æ¨¡å‹é…ç½®

### Q3: å¦‚ä½•å¢é‡è®­ç»ƒï¼Ÿ

**å‘½ä»¤**:
```bash
python3 scripts/core/pipeline.py \
  --skip scrape,analyze,generate \
  --incremental \
  --epochs 10
```

---

## ç›®å½•ç»“æ„è¯´æ˜

### novelsç›®å½•ï¼ˆçˆ¬å–åï¼‰
```
data/training/novels/
â””â”€â”€ <ç½‘ç«™å>/
    â””â”€â”€ <ç±»å‹>/
        â””â”€â”€ <å°è¯´å>/
            â”œâ”€â”€ <å°è¯´å>.txt
            â””â”€â”€ <å°è¯´å>.json
```

### processedç›®å½•ï¼ˆæ•´ç†åï¼‰
```
data/training/processed/
â””â”€â”€ <ç±»å‹>/
    â””â”€â”€ <å°è¯´å>.txt
```

### è®­ç»ƒæ•°æ®
```
data/training/processed/
â”œâ”€â”€ training_data.txt      # è®­ç»ƒæ•°æ®
â”œâ”€â”€ training_stats.json    # ç»Ÿè®¡ä¿¡æ¯
â””â”€â”€ analysis.json          # åˆ†æç»“æœ
```

### æ¨¡å‹æ–‡ä»¶
```
models/
â””â”€â”€ text_rewriter/
    â”œâ”€â”€ checkpoint
    â”œâ”€â”€ model_weights.h5
    â””â”€â”€ ...
```

---

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **æ•°æ®é‡**: å»ºè®®è‡³å°‘10æœ¬å°è¯´ï¼Œæ€»å­—ç¬¦æ•°>1000ä¸‡
2. **æ‰¹æ¬¡å¤§å°**: æ ¹æ®å†…å­˜è°ƒæ•´ï¼Œå»ºè®®8-32
3. **è®­ç»ƒè½®æ•°**: å»ºè®®10-50 epochs
4. **æ•°æ®å¢å¼º**: å¯ä»¥å¢åŠ æ ·æœ¬å¤šæ ·æ€§
5. **å¢é‡è®­ç»ƒ**: æ–°æ•°æ®å¯ä»¥å¢é‡è®­ç»ƒï¼Œæ— éœ€ä»å¤´å¼€å§‹

---

## ç›¸å…³æ–‡æ¡£

- `docs/reports/optimization/WORKFLOW_ISSUES_AND_FIXES.md` - é—®é¢˜åˆ†æä¸ä¿®å¤
- `docs/reports/project/DATA_ANALYSIS_AND_TRAINING.md` - æ•°æ®åˆ†ææŠ¥å‘Š
- `scripts/core/pipeline.py` - æµæ°´çº¿ä»£ç 
- `scripts/core/training_data_generator.py` - è®­ç»ƒæ•°æ®ç”Ÿæˆå™¨

