# 文件迁移指南

## 概述

如果你有之前生成的小说文件在项目根目录，可以使用迁移工具将它们移动到新的文件夹结构中。

## 使用方法

### 基本用法

```bash
python3 migrate_novels.py
```

### 指定输出文件夹（可选）

```bash
python3 migrate_novels.py novels
```

## 迁移规则

迁移工具会自动：

1. **扫描文件**
   - 查找当前目录下的所有 `.txt` 和 `.json` 文件
   - 自动过滤掉非小说文件（如 `requirements.txt`、`README.txt` 等）

2. **提取标题**
   - 优先从文件内容中提取标题（读取第一行的"标题: xxx"）
   - 如果无法从内容提取，则使用文件名（去除扩展名）

3. **创建文件夹**
   - 根据小说标题创建文件夹：`novels/小说标题/`
   - 自动清理标题中的非法字符

4. **移动文件**
   - 将文件移动到对应的文件夹中
   - 如果目标文件已存在，会跳过该文件（避免覆盖）

## 迁移示例

### 迁移前

```
getBook/
├── 结婚当天我拒绝了临时加彩礼之后.txt
├── 另一部小说.txt
└── ...
```

### 迁移后

```
getBook/
├── novels/
│   ├── 结婚当天我拒绝了临时加彩礼之后/
│   │   └── 结婚当天我拒绝了临时加彩礼之后.txt
│   ├── 另一部小说/
│   │   └── 另一部小说.txt
│   └── ...
└── ...
```

## 支持的文件类型

- ✅ `.txt` 文件（小说文本文件）
- ✅ `.json` 文件（小说JSON数据文件）
- ✅ `.*_progress.json` 文件（进度文件）

## 注意事项

1. **备份重要文件**：虽然迁移工具会跳过已存在的文件，但建议先备份重要文件

2. **文件大小**：大文件迁移可能需要一些时间，请耐心等待

3. **权限问题**：确保对目标文件夹有写入权限

4. **重复运行**：可以安全地重复运行迁移工具，已存在的文件会被跳过

## 故障排除

### 问题：文件没有被迁移

**可能原因**：
- 文件名在排除列表中（如 `requirements.txt`）
- 目标文件已存在

**解决方法**：
- 检查文件名是否在排除列表中
- 检查目标文件夹中是否已有同名文件

### 问题：无法创建文件夹

**可能原因**：
- 权限不足
- 磁盘空间不足

**解决方法**：
- 检查文件夹权限
- 检查磁盘空间

### 问题：标题提取失败

**可能原因**：
- 文件格式不正确
- 文件编码问题

**解决方法**：
- 检查文件格式
- 确保文件是UTF-8编码

## 手动迁移

如果自动迁移工具无法满足需求，也可以手动迁移：

1. 创建文件夹：`novels/小说标题/`
2. 移动文件到该文件夹
3. 确保文件命名正确

